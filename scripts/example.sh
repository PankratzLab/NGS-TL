#!/bin/bash

module load bedtools
module load R
module load samtools/1.14

gcBedFile=/home/pankrat2/public/bin/ref/GRCh38_full_analysis_set_plus_decoy_hla.1kb.LTL.GC.filtered.bed.gz
mosdepthFile=/scratch.global/lanej/topMed/mosdepth.all/data/mosdepth/broad/WHI/NWD883937/NWD883937.by1000.regions.bed.gz
outputFile=/home/tsaim/lane0212/tmp/LTL_tests/NWD883937.gc.stats.txt.gz


bamOrCram=/scratch.global/lanej/topMed/LTL/experimental/bams_BDC_LTL_V2/NWD883937.b38.irc.v1.LTL.bam
outputFile=/home/tsaim/lane0212/tmp/LTL_tests/NWD883937.ltl.counts.txt.gz




tlCountFile="/Users/Kitty/tmp/LTL_tests/NWD883937.ltl.counts.txt.gz"
gcStatsFile="/Users/Kitty/tmp/LTL_tests/NWD883937.gc.stats.txt.gz"
samtoolsStatsFile="/Users/Kitty/tmp/LTL_tests/NWD883937.stats.txt.gz"
kmax=25
output="/Users/Kitty/tmp/LTL_tests/NWD883937.estimate.txt.gz"



# load("/Volumes/Beta2/NGS/topmed/LTL/experiment/compute/tl.Rdata")
# > tl[which(tl$SOURCE_MATCH =="NWD883937"),]$LENGTH_ESTIMATE_MD_mean
# [1] 169.0785

mosdepth_gc_coverage_min	mosdepth_gc_coverage_max	mosdepth_gc_coverage_mean	mosdepth_gc_coverage_sd	mosdepth_gc_coverage_median	mosdepth_gc_coverage_mad	mosdepth_gc_coverage_iqr	mosdepth_gc_coverage_n	READ_LENGTH	TL_READS_AT_K_1	LENGTH_ESTIMATE_AT_K_1	TL_READS_AT_K_2	LENGTH_ESTIMATE_AT_K_2	TL_READS_AT_K_3	LENGTH_ESTIMATE_AT_K_3	TL_READS_AT_K_4	LENGTH_ESTIMATE_AT_K_4	TL_READS_AT_K_5	LENGTH_ESTIMATE_AT_K_5	TL_READS_AT_K_6	LENGTH_ESTIMATE_AT_K_6	TL_READS_AT_K_7	LENGTH_ESTIMATE_AT_K_7	TL_READS_AT_K_8	LENGTH_ESTIMATE_AT_K_8	TL_READS_AT_K_9	LENGTH_ESTIMATE_AT_K_9	TL_READS_AT_K_10	LENGTH_ESTIMATE_AT_K_10	TL_READS_AT_K_11	LENGTH_ESTIMATE_AT_K_11	TL_READS_AT_K_12	LENGTH_ESTIMATE_AT_K_12	TL_READS_AT_K_13	LENGTH_ESTIMATE_AT_K_13	TL_READS_AT_K_14	LENGTH_ESTIMATE_AT_K_14	TL_READS_AT_K_15	LENGTH_ESTIMATE_AT_K_15	TL_READS_AT_K_16	LENGTH_ESTIMATE_AT_K_16	TL_READS_AT_K_17	LENGTH_ESTIMATE_AT_K_17	TL_READS_AT_K_18	LENGTH_ESTIMATE_AT_K_18	TL_READS_AT_K_19	LENGTH_ESTIMATE_AT_K_19	TL_READS_AT_K_20	LENGTH_ESTIMATE_AT_K_20	TL_READS_AT_K_21	LENGTH_ESTIMATE_AT_K_21	TL_READS_AT_K_22	LENGTH_ESTIMATE_AT_K_22	TL_READS_AT_K_23	LENGTH_ESTIMATE_AT_K_23	TL_READS_AT_K_24	LENGTH_ESTIMATE_AT_K_24	TL_READS_AT_K_25	LENGTH_ESTIMATE_AT_K_25
0	202.21	16.22164	18.3751	2.09	3.098634	36.86	24563	151	83166	227.965283421925	76011	208.352802325277	74964	205.48288370778	74039	202.947377765865	72693	199.257873984441	70743	193.912753350134	68308	187.238205276013	65480	179.486409812516	62425	171.112387485435	58934	161.543251006273	55379	151.798684926807	51644	141.560723096481	47955	131.448851291374	44275	121.361649273811	40895	112.096773507679	37590	103.037479304405	34478	94.5072149895527	31471	86.2647648627012	28455	77.9976449483068	25424	69.6894087213408	22292	61.1043226563927	18982	52.0313230155951	15243	41.7823968352501	10673	29.2556269384389	2841	7.7874296010592


62425


169.0785

> tl[which(tl$SOURCE_MATCH =="NWD883937"),]$READS_TOTAL
[1] 61683


-F 0x900

16.22164